{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback } from 'react';\nimport { formatDate, getWeekDates, calculateShiftHours } from '../utils/dateUtils';\nexport const useSchedule = (employees, shiftTemplates, currentWeekStart, unavailability, closedDates) => {\n  _s();\n  const [schedule, setSchedule] = useState({});\n  const canWorkShift = useCallback((employeeId, shiftKey) => {\n    const employee = employees.find(emp => emp.id === employeeId);\n    if (!employee || !employee.shiftAvailability) return true;\n    if (employee.shiftAvailability.hasOwnProperty(shiftKey)) {\n      return employee.shiftAvailability[shiftKey];\n    }\n    return true;\n  }, [employees]);\n  const isUnavailable = useCallback((employeeId, date) => {\n    const dateStr = formatDate(date);\n    const key = `${employeeId}-${dateStr}`;\n    return unavailability[key] || false;\n  }, [unavailability]);\n  const isStoreClosed = useCallback(date => {\n    const dateStr = formatDate(date);\n    return closedDates[dateStr] || false;\n  }, [closedDates]);\n  const generateSchedule = useCallback(getShiftTimes => {\n    const newSchedule = {};\n    const weekDates = getWeekDates(currentWeekStart);\n    const employeeHours = {};\n    employees.forEach(emp => {\n      employeeHours[emp.id] = 0;\n    });\n    const shiftKeys = Object.keys(shiftTemplates);\n    weekDates.forEach(date => {\n      const dateStr = formatDate(date);\n      newSchedule[dateStr] = {};\n      if (isStoreClosed(date)) {\n        shiftKeys.forEach(shiftKey => {\n          newSchedule[dateStr][shiftKey] = 'CLOSED';\n        });\n        return;\n      }\n      shiftKeys.forEach(shiftKey => {\n        const availableEmployees = employees.filter(emp => !isUnavailable(emp.id, date) && canWorkShift(emp.id, shiftKey));\n        if (availableEmployees.length > 0) {\n          availableEmployees.sort((a, b) => employeeHours[a.id] - employeeHours[b.id]);\n          const assignedEmployee = availableEmployees[0];\n          newSchedule[dateStr][shiftKey] = assignedEmployee.id;\n          const shiftTimes = getShiftTimes(date, shiftKey);\n          const hours = calculateShiftHours(shiftTimes.start, shiftTimes.end);\n          employeeHours[assignedEmployee.id] += hours;\n        } else {\n          newSchedule[dateStr][shiftKey] = null;\n        }\n      });\n    });\n    setSchedule(newSchedule);\n  }, [employees, shiftTemplates, currentWeekStart, isUnavailable, isStoreClosed, canWorkShift]);\n  return {\n    schedule,\n    setSchedule,\n    generateSchedule,\n    canWorkShift,\n    isUnavailable,\n    isStoreClosed\n  };\n};\n_s(useSchedule, \"C0iBsHplYeGct1QKBg/zQIrOJkM=\");","map":{"version":3,"names":["useState","useCallback","formatDate","getWeekDates","calculateShiftHours","useSchedule","employees","shiftTemplates","currentWeekStart","unavailability","closedDates","_s","schedule","setSchedule","canWorkShift","employeeId","shiftKey","employee","find","emp","id","shiftAvailability","hasOwnProperty","isUnavailable","date","dateStr","key","isStoreClosed","generateSchedule","getShiftTimes","newSchedule","weekDates","employeeHours","forEach","shiftKeys","Object","keys","availableEmployees","filter","length","sort","a","b","assignedEmployee","shiftTimes","hours","start","end"],"sources":["C:/Users/npnic/OneDrive/Documentos/Scheduling-Website-/src/hooks/useSchedule.js"],"sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { formatDate, getWeekDates, calculateShiftHours } from '../utils/dateUtils';\r\n\r\nexport const useSchedule = (employees, shiftTemplates, currentWeekStart, unavailability, closedDates) => {\r\n  const [schedule, setSchedule] = useState({});\r\n\r\n  const canWorkShift = useCallback((employeeId, shiftKey) => {\r\n    const employee = employees.find((emp) => emp.id === employeeId);\r\n    if (!employee || !employee.shiftAvailability) return true;\r\n    if (employee.shiftAvailability.hasOwnProperty(shiftKey)) {\r\n      return employee.shiftAvailability[shiftKey];\r\n    }\r\n    return true;\r\n  }, [employees]);\r\n\r\n  const isUnavailable = useCallback((employeeId, date) => {\r\n    const dateStr = formatDate(date);\r\n    const key = `${employeeId}-${dateStr}`;\r\n    return unavailability[key] || false;\r\n  }, [unavailability]);\r\n\r\n  const isStoreClosed = useCallback((date) => {\r\n    const dateStr = formatDate(date);\r\n    return closedDates[dateStr] || false;\r\n  }, [closedDates]);\r\n\r\n  const generateSchedule = useCallback((getShiftTimes) => {\r\n    const newSchedule = {};\r\n    const weekDates = getWeekDates(currentWeekStart);\r\n    const employeeHours = {};\r\n\r\n    employees.forEach((emp) => {\r\n      employeeHours[emp.id] = 0;\r\n    });\r\n\r\n    const shiftKeys = Object.keys(shiftTemplates);\r\n\r\n    weekDates.forEach((date) => {\r\n      const dateStr = formatDate(date);\r\n      newSchedule[dateStr] = {};\r\n\r\n      if (isStoreClosed(date)) {\r\n        shiftKeys.forEach((shiftKey) => {\r\n          newSchedule[dateStr][shiftKey] = 'CLOSED';\r\n        });\r\n        return;\r\n      }\r\n\r\n      shiftKeys.forEach((shiftKey) => {\r\n        const availableEmployees = employees.filter(\r\n          (emp) => !isUnavailable(emp.id, date) && canWorkShift(emp.id, shiftKey)\r\n        );\r\n\r\n        if (availableEmployees.length > 0) {\r\n          availableEmployees.sort((a, b) => employeeHours[a.id] - employeeHours[b.id]);\r\n          const assignedEmployee = availableEmployees[0];\r\n          newSchedule[dateStr][shiftKey] = assignedEmployee.id;\r\n\r\n          const shiftTimes = getShiftTimes(date, shiftKey);\r\n          const hours = calculateShiftHours(shiftTimes.start, shiftTimes.end);\r\n          employeeHours[assignedEmployee.id] += hours;\r\n        } else {\r\n          newSchedule[dateStr][shiftKey] = null;\r\n        }\r\n      });\r\n    });\r\n\r\n    setSchedule(newSchedule);\r\n  }, [employees, shiftTemplates, currentWeekStart, isUnavailable, isStoreClosed, canWorkShift]);\r\n\r\n  return {\r\n    schedule,\r\n    setSchedule,\r\n    generateSchedule,\r\n    canWorkShift,\r\n    isUnavailable,\r\n    isStoreClosed,\r\n  };\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}